# Slipstream Optimized Build

This document serves as a general guide on the optimized build.  The intended audience is a development operations team and Slipstream application developers.  It will describe 3 things:

1) How to use the build system.
2) How to use the output generated by the optimized build task.
3) The details of the build system and the options used in the build configuration.

Use this documentation to understand how to consume and use the various build artifacts and also to extend the tasks that make up the build configuration file.

## The Build System

#### Basics
The Slipstream build system uses the Javascript based build tool named Grunt.  Like most modern build tools, grunt is a task runner.  The 'task' is an abstraction used to encapsulate the basic unit that compose a build system.  Moreover, a 'build' is a set of tasks that produces output(s).  The output(s) are build artifacts.

So we have a **build system** that is composed of (build) **tasks** and produces (build) **artifacts**.


The Slipstream build system's build configuration file is named: **Gruntfile.js**  In the config file are several tasks - each one producing a unique set of build artifacts:

| Task name | Optimized CSS | Concat'ed JS  | Minified JS  | JSDocs  | Zip File  |  Unit Tests Executed
| --------- |:--------------|:--------------|:-------------|:--------|:----------|:---------------------| 
| full      |  Yes 	   	    |   Yes			| Yes	       | Yes     | Yes 	 	 | Yes
| dev		|  Yes		   	|   No  	    | No		   | No	     | Yes	     | No
| testBuild |  Yes 	   	    |   Yes			| Yes	       | No      | Yes 	 	 | No  


Executing build tasks:

In the Slipstream root directory, you should see a file named **Gruntfile.js**.  Assuming you have node and grunt installed, run:
```
grunt <task name>
```

For example:
```
grunt testBuild
```

####Build Artifacts

When running any of the aforementioned build tasks (listed above) the resultant artifacts will be placed in ***{slipstream root directory}/dist***.

The three main artifacts of interest:


**dist/all**  -- a non-optimized build of the slipstream application

**dist/mini**  -- a fully optimized build of the slipstream application.  The slipstream framework and widgets are concat'ed and minified into a few js files.

**dist/concat** -- partically optimized build of the slipstream application.  The slipstream framework and widgets are only concat'ed into a few js files.  Unlike the fully optimized build, the resultant js files are not minified and thus the source is human readable in a debugger.


Each of the build artifacts listed above are deployable - in that you can run the Slipstream app from the directory using 

```
npm start
```

## Adding New Widgets

### 
When new widgets are created the build configuration  will need to know about it.  This is so that when the minificaiton process is run on the build configuration (in our case, main.js) it can

(1) locate the source file

(2) include the source file in minification output

(3) resolve all requests for the source file when a client requests the source file.


To do you will need to make changes to main.js - specifically you will need to add an entry to the build config's include array.

Look for the 'include' array in main.js.  Follow the current pattern of adding the path to the widget in the array.

For example, we would add it to the include block like so:

In main.js, look for the 'include' array.

```javascript
  include: [
        'sdk/userToolbarElement',
        'widgets/barChart/barChartWidget',
        ...
        'path/To/myNewWidget'
        ...
        ]
```

#####Summary
When adding a new widget:

    add an entry in main.js to the require.config.include, where the entry key string is the alias assigned in step 1.


